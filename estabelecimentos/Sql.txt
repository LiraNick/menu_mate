BEGIN;
--
-- Create model Comanda
--
CREATE TABLE "comanda" ("comanda_id" integer NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY);
--
-- Create model Estabelecimento
--
CREATE TABLE "estabelecimento" (
    "estabelecimento_id" integer NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    "estabelecimento_nome" varchar(100) NOT NULL,
    "estabelecimento_endereco" varchar(200) NOT NULL,
    "estabelecimento_telefone" varchar(20) NOT NULL);
--
-- Create model Mesa
--
CREATE TABLE "mesa" (
    "mesa_id" integer NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    "mesa_numero" integer NOT NULL,
    "mesa_capacidade" integer NOT NULL,
    "mesa_status" boolean NOT NULL,
    "estabelecimento_id" integer NOT NULL);
--
-- Create model Reserva
--
CREATE TABLE "reserva" (
    "reserva_id" integer NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    "reserva_reserva" timestamp with time zone NOT NULL,
    "reserva_nome_cliente" varchar(100) NOT NULL,
    "mesa_id" integer NOT NULL);
--
-- Create model Recibo
--
CREATE TABLE "recibo" (
    "recibo_id" integer NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    "recibo_subtotal" numeric(10, 2) NOT NULL,
    "recibo_taxas" numeric(10, 2) NOT NULL,
    "recibo_total" numeric(10, 2) NOT NULL,
    "comanda_id" integer NOT NULL);
--
-- Create model Menu
--
CREATE TABLE "menu" (
    "menu_id" integer NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    "menu_nome" varchar(100) NOT NULL,
    "estabelecimento_id" integer NOT NULL);
--
-- Create model ItemMenu
--
CREATE TABLE "itemmenu" (
    "item_menu_id" integer NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    "item_menu_nome" varchar(100) NOT NULL,
    "item_menu_preco" numeric(10, 2) NOT NULL,
    "menu_id" integer NOT NULL);
--
-- Create model ItemComanda
--
CREATE TABLE "itemcomanda" (
    "item_comanda_id" integer NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    "item_comanda_quantidade" integer NOT NULL,
    "comanda_id" integer NOT NULL,
    "item_id" integer NOT NULL);
--
-- Create model Garcom
--
CREATE TABLE "garcom" (
    "garcom_id" integer NOT NULL PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    "garcom_nome" varchar(100) NOT NULL,
    "estabelecimento_id" integer NOT NULL);
--
-- Add field garcom to comanda
--
ALTER TABLE "comanda" ADD COLUMN "garcom_id" integer NOT NULL CONSTRAINT "comanda_garcom_id_da49d9c4_fk_garcom_garcom_id" REFERENCES "garcom"("garcom_id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "comanda_garcom_id_da49d9c4_fk_garcom_garcom_id" IMMEDIATE;
--
-- Add field mesa to comanda
--
ALTER TABLE "comanda" ADD COLUMN "mesa_id" integer NOT NULL CONSTRAINT "comanda_mesa_id_e3322495_fk_mesa_mesa_id" REFERENCES "mesa"("mesa_id") DEFERRABLE INITIALLY DEFERRED; SET CONSTRAINTS "comanda_mesa_id_e3322495_fk_mesa_mesa_id" IMMEDIATE;
ALTER TABLE "mesa" ADD CONSTRAINT "mesa_estabelecimento_id_10fbb0d8_fk_estabelec" FOREIGN KEY ("estabelecimento_id") REFERENCES "estabelecimento" ("estabelecimento_id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "mesa_estabelecimento_id_10fbb0d8" ON "mesa" ("estabelecimento_id");
ALTER TABLE "reserva" ADD CONSTRAINT "reserva_mesa_id_81ba2ebb_fk_mesa_mesa_id" FOREIGN KEY ("mesa_id") REFERENCES "mesa" ("mesa_id") DEFERRABLE INITIALLY DEFERRED; 
CREATE INDEX "reserva_mesa_id_81ba2ebb" ON "reserva" ("mesa_id");
ALTER TABLE "recibo" ADD CONSTRAINT "recibo_comanda_id_91d43234_fk_comanda_comanda_id" FOREIGN KEY ("comanda_id") REFERENCES "comanda" ("comanda_id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "recibo_comanda_id_91d43234" ON "recibo" ("comanda_id");
ALTER TABLE "menu" ADD CONSTRAINT "menu_estabelecimento_id_e1c2e12d_fk_estabelec" FOREIGN KEY ("estabelecimento_id") REFERENCES "estabelecimento" ("estabelecimento_id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "menu_estabelecimento_id_e1c2e12d" ON "menu" ("estabelecimento_id");
ALTER TABLE "itemmenu" ADD CONSTRAINT "itemmenu_menu_id_b3093fd5_fk_menu_menu_id" FOREIGN KEY ("menu_id") REFERENCES "menu" ("menu_id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "itemmenu_menu_id_b3093fd5" ON "itemmenu" ("menu_id");
ALTER TABLE "itemcomanda" ADD CONSTRAINT "itemcomanda_comanda_id_0fa5e6a4_fk_comanda_comanda_id" FOREIGN KEY ("comanda_id") REFERENCES "comanda" ("comanda_id") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "itemcomanda" ADD CONSTRAINT "itemcomanda_item_id_8dffb555_fk_itemmenu_item_menu_id" FOREIGN KEY ("item_id") REFERENCES "itemmenu" ("item_menu_id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "itemcomanda_comanda_id_0fa5e6a4" ON "itemcomanda" ("comanda_id");
CREATE INDEX "itemcomanda_item_id_8dffb555" ON "itemcomanda" ("item_id");
ALTER TABLE "garcom" ADD CONSTRAINT "garcom_estabelecimento_id_64e776e5_fk_estabelec" FOREIGN KEY ("estabelecimento_id") REFERENCES "estabelecimento" ("estabelecimento_id") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "garcom_estabelecimento_id_64e776e5" ON "garcom" ("estabelecimento_id");
CREATE INDEX "comanda_garcom_id_da49d9c4" ON "comanda" ("garcom_id");
CREATE INDEX "comanda_mesa_id_e3322495" ON "comanda" ("mesa_id");

COMMIT;